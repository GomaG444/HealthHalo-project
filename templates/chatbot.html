<script>
    async function sendMessage() {
        const input = document.getElementById('chatInput');
        const messages = document.getElementById('chatMessages');
        const userMessage = input.value.trim();
        if (!userMessage) return;
    
        // Show user's message
        messages.innerHTML += `<p><strong>You:</strong> ${userMessage}</p>`;
        messages.scrollTop = messages.scrollHeight;
        input.value = '';
    
        // Prepare features to send to backend
        // TODO: Replace this with real feature extraction from userMessage
        const exampleFeatures = {
            age: 50,
            sex: 1,
            cholesterol: 230,
            blood_pressure: 120
        };
    
        try {
            // Send POST request to /predict with example features
            const response = await fetch('/predict', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ features: exampleFeatures })
            });
    
            const data = await response.json();
    
            if (response.ok) {
                // Show AI prediction from ML model
                messages.innerHTML += `<p><strong>AI:</strong> Predicted class: ${data.predicted_class}, Risk score: ${data.risk_score.toFixed(2)}</p>`;
            } else {
                messages.innerHTML += `<p><strong>AI:</strong> Error: ${data.error}</p>`;
            }
        } catch (error) {
            messages.innerHTML += `<p><strong>AI:</strong> Failed to get response.</p>`;
        }
    
        messages.scrollTop = messages.scrollHeight;
    }
    
    document.getElementById('chatInput').addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            sendMessage();
        }
    });
    </script>
    